{"version":3,"file":"workbook.js","sourceRoot":"","sources":["../../src/core/workbook.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  AbstractWorkbook,\n  CreateSheetsOptions,\n  ResponseOfSheets\n} from '../abstracts/workbook.abstract';\nimport { Theme } from './theme';\nimport Base from './base';\nimport * as Core from 'xmind-model';\nimport { ErrorObject } from 'ajv';\n\n/**\n * @description The implementation of Workbook\n * @extends {Base}\n */\nexport class Workbook extends Base implements AbstractWorkbook {\n  public sheet: Core.Sheet;\n  private workbook: Core.Workbook;\n  private readonly resources;\n\n\n  constructor() {\n    super();\n    this.resources = {};\n  }\n\n\n  public theme(sheetTitle:string, themeName: string) {\n    /* istanbul ignore next */\n    if (!sheetTitle || !this.resources[sheetTitle]) {\n      return false;\n    }\n    /* istanbul ignore next */\n    if (!themeName || typeof themeName !== 'string') {\n      return false;\n    }\n\n    const instance = new Theme({themeName});\n    this.sheet.changeTheme(instance.data);\n    return true;\n  }\n\n\n  public toString() {\n    return this.workbook.toString();\n  }\n\n  public toJSON() {\n    return this.workbook.toJSON();\n  }\n\n  public validate() {\n    return Core.validator(this.workbook.toJSON()) as {\n      status: boolean,\n      errors: ErrorObject[]\n    };\n  }\n\n  public getSheets(): ResponseOfSheets[] {\n    return Object.entries(this.resources || {})\n      .map(sheet => ({ id: sheet[1] as string, title: sheet[0] }));\n  }\n\n  public getSheet(id: string) {\n    if (!id) {\n      throw new Error('The sheetId is required');\n    }\n    return this.workbook.getSheetById(id);\n  }\n\n  public createSheets(options: CreateSheetsOptions[] = []): ResponseOfSheets[] {\n    if (options.length <= 0) {\n      throw new Error('Options are empty');\n    }\n\n    const sheets = [];\n    const created = [];\n    for (let i = 0; i < options.length; i++) {\n      if (this.resources.hasOwnProperty(options[i].s)) {\n        continue;\n      }\n      const id = this.id;\n      this.resources[options[i].s] = id;\n      const sheetBody = { id, title: options[i].s };\n      const rootTopic = { rootTopic: { id: this.id, title: options[i].t } };\n      sheets.push(Object.assign({}, sheetBody, rootTopic));\n      created.push(sheetBody);\n    }\n\n    this.workbook = new Core.Workbook(sheets);\n    return created;\n  }\n\n  public createSheet(sheetTitle: string, centralTopicTitle = 'Central Topic') {\n    if (!sheetTitle) {\n      throw new Error('The title of sheet is required');\n    }\n\n    if (this.resources.hasOwnProperty(sheetTitle)) {\n      throw new Error('You are trying to create the sheet repeatedly that is not allowed');\n    }\n\n    const sheetId = this.id;\n    this.resources[sheetTitle] = sheetId;\n\n    const options = [{\n      id: sheetId, title: sheetTitle,\n      rootTopic: { id: this.id, title: centralTopicTitle }\n    }];\n    this.workbook = new Core.Workbook(options);\n    this.sheet = this.workbook.getSheetById(sheetId);\n    return this.sheet;\n  }\n}\n"]}